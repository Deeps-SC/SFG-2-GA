def get_sftp_profile_details(conn, profile_name):
    query = """
        SELECT 
            sftp.*, 
            ssh_khk.*
        FROM 
            sftp_prof sftp
        LEFT JOIN 
            sftp_prof_xref_khost_key sftpx ON sftpx.profile_id = sftp.profile_id
        LEFT JOIN 
            ssh_khost_key ssh_khk ON ssh_khk.name = sftpx.khost_key_id
        WHERE 
            sftp.name = ?
    """
    return your_adapter_method(conn, query, [profile_name])
