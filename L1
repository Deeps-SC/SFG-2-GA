import logging
from logging.handlers import RotatingFileHandler
import getpass

# Get the username of the person running the script
USER = getpass.getuser()

# --- Logging Setup ---
file_handler = RotatingFileHandler("app.log", maxBytes=5_000_000, backupCount=3)
console_handler = logging.StreamHandler()

# Add user info in the log format
formatter = logging.Formatter(f"%(asctime)s - %(levelname)s - {USER} - %(message)s")

file_handler.setFormatter(formatter)
console_handler.setFormatter(formatter)

logging.basicConfig(
    level=logging.INFO,
    handlers=[file_handler, console_handler]
)

# --- Example ---
logging.info("Application started")
try:
    1 / 0
except Exception:
    logging.exception("An exception occurred")
logging.info("Program finished")
