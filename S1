SELECT fr.ROUTCHAN_KEY,
       fr.MAILBOX_NAME        AS PRODUCER_MAILBOX,
       st.RECEIVING_PROTOCOL,
       prod_sp.OBJECT_NAME    AS PRODUCER_PROFILE,
       cons_sp.OBJECT_NAME    AS CONSUMER_PROFILE
FROM FG_ROUTCHAN fr
JOIN FG_DELIVCHAN fd
  ON fr.ROUTCHAN_KEY = fd.ROUTCHAN_KEY
JOIN SCI_DELIV_CHAN sdc
  ON fd.DELIVCHAN_KEY = sdc.OBJECT_ID
JOIN SCI_TRANSPORT st
  ON sdc.TRANSPORT_ID = st.TRANSPORT_ID
JOIN SCI_PROFILE prod_sp
  ON fr.PROD_ORG_KEY = prod_sp.PROFILE_ID
LEFT JOIN SCI_DOC_EXCHANGE sde
  ON sdc.DOC_EXCHANGE_ID = sde.OBJECT_ID
LEFT JOIN SCI_PROFILE cons_sp
  ON sde.PROFILE_ID = cons_sp.PROFILE_ID
WHERE st.RECEIVING_PROTOCOL = 'FTP';
