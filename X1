def enhance_matched_schedules_with_protocol_profiles(matched_schedules):
    for schedule in matched_schedules:
        params = schedule.get("SCHEDULE_PARAMS", {}).get("DataXML", {}).get("Parameter", [])
        if not isinstance(params, list):
            params = [params]

        protocol_value = None
        sftp_profile_name = None
        ftp_profile_name = None

        for param in params:
            name = param.get("Name", "").strip()
            value = param.get("Value", "").strip()

            if name == "Protocol":
                protocol_value = value.upper()
            elif name == "SFTPProfile":
                sftp_profile_name = value
            elif name == "FTPProfile":
                ftp_profile_name = value

        if protocol_value == "SFTP" and sftp_profile_name:
            # Replace this with your actual implementation
            sftp_details = get_sftp_profile_details(sftp_profile_name)
            schedule["SFTP_PROFILE_DETAILS"] = sftp_details

        elif protocol_value == "FTP" and ftp_profile_name:
            # Replace this with your actual implementation
            ftp_details = get_ftp_profile_details(ftp_profile_name)
            schedule["FTP_PROFILE_DETAILS"] = ftp_details
